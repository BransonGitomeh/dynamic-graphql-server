require("source-map-support").install(),function(n){function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var t={};e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:r})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},e.p="",e(e.s=1)}([function(n,e){n.exports=require("mongodb")},function(n,e,t){"use strict";function r(n){var e=i(n.Type);return n.Type&&1==n.list&&(e="["+e+"]"),1==n.required&&(e+="!"),e}function o(n){var e=["Int","String","Boolean","Float"],t=i(n.Type);return-1==e.indexOf(t)&&(t="input_"+i(n.Type)),1==n.list&&(t="["+t+"]"),1==n.required&&(t+="!"),t}function i(n){return n.replace(/ /g,"_")}function a(n){var e=i(n.name);return 1==n.list&&(e+="(first:Int,after:String,offSet:Int)"),e}function u(){return new Promise(function(n,e){y.post({url:"http://localhost:3000/graphql",form:{query:"query te{\n                          Types {\n                            _id\n                            name,\n                            description,\n                            Props{\n                              _id,\n                              name,\n                              required,\n                              description,\n                              list,\n                              Type\n                            }\n                          }\n                        }"}},function(e,t){console.log(e);var u=JSON.parse(t.body).data;console.log(u);var p="\n              type Query {\n                "+u.Types.map(function(n){return"\n# "+n.description+" \n \n                  "+i(n.name.toString())+"(_id:String) : "+i(n.name.toString())}).join(" ")+"\n                "+u.Types.map(function(n){return"\n# list of "+n.description+" \n \n                  "+i(n.name.toString())+"s : ["+i(n.name.toString())+"]"}).join(" ")+"\n              }\n\n              "+u.Types.map(function(n){return"\n# "+n.description+"\n type "+i(n.name)+" {\n                "+n.Props.map(function(n){return"\n# "+n.description+" \n \n                  "+a(n)+": "+r(n)}).join(" ")+"\n              }"}).join(" ")+"\n            ",c="\n              type Mutation {\n                "+u.Types.map(function(n){return"\n# "+n.description+" \n\n                  "+i(n.name.toString())+"Mutations : "+i(n.name.toString())+"Mutations"}).join(" ")+"\n              }\n\n              "+u.Types.map(function(n){return"type "+n.name+"Mutations {\n                      Create(\n                          "+n.name+":input_"+n.name+"\n                      ): "+n.name+",\n\n                      Update(\n                          "+n.name+":input_"+n.name+"\n                      ): "+n.name+",\n\n                      Delete(\n                          "+n.name+":input_"+n.name+"\n                      ): "+n.name+"\n                  }"})+"\n              \n\n              "+u.Types.map(function(n){return"\n# "+n.description+"\n input input_"+i(n.name)+" {\n                "+n.Props.map(function(n){return"\n# "+n.description+" \n "+i(n.name)+": "+o(n)}).join(" ")+"\n              }"}).join(" ")+"\n            ";n(f(p+c))})})}var p=t(2),c=new p,s=t(3),l=t(4),f=(l.graphql,l.buildSchema),d=t(0).MongoClient,g=t(0).ObjectId,m="mongodb://localhost:27017/coola",y=t(5);m="mongodb://branson:a323573770@ds141082.mlab.com:41082/coola",d.connect(m,function(n,e){n?(console.log(n),console.log("could not connet to the database")):console.log("database connected succesfully");var t=f("\n          type Query {\n            hello: String,\n            Type(_id: String):Type,\n            Types:[Type],\n            Prop:Prop,\n            Props:[Prop],\n            Relationship:Relationship,\n            Relationships:[Relationship]\n          }\n\n          type Mutation {\n           addType(\n            name: String,\n            description:String,\n           ): String,\n           addProp(\n             name: String,\n             list: Boolean,\n             Parent:String,\n             Type:String,\n             required:Boolean,\n             description:String,\n           ): String,\n           relate(origin: String,target: String): String\n          }\n\n          type Type {\n            _id: String,\n            name: String,\n            description : String,\n            Props:[Prop]\n          }\n\n          type Prop {\n            _id: String,\n            Parent:Type,\n            list: Boolean,\n            required:Boolean,\n            description:String,\n            name: String,\n            Type:String\n          }\n\n          type Relationship {\n            _id: String,\n            origin: Type,\n            target: Type,\n          }\n        "),r={hello:function(){return"Hello world!"},Type:function(n){var t=n._id;return new Promise(function(n,r){var o=e.collection("Types");console.log(t),o.findOne({_id:new g(t)},function(t,r){r&&(r.Props=function(){return new Promise(function(n,t){e.collection("Props").find({Parent:new g(r._id)}).toArray(function(e,t){n(t)})})}),console.log(r),n(r)})})},Types:function(){return new Promise(function(n,t){e.collection("Types").find().toArray(function(t,r){r.forEach(function(n){n.Props=function(){return new Promise(function(t,r){e.collection("Props").find({Parent:new g(n._id)}).toArray(function(n,e){t(e)})})}}),n(r)})})},addType:function(n){return new Promise(function(t,r){e.collection("Types").insertOne(n,function(n,e){t(e)})})},addProp:function(n){return new Promise(function(t,r){var o=e.collection("Props");n.Parent=new g(n.Parent),o.insertOne(n,function(n,e){t(e)})})}};c.use(p.static("./www")),c.use("/graphql",s({schema:t,rootValue:r,graphiql:!0})),c.use("/graphql2",function(n,e,t){u().then(function(e){n.schema=e,t()})},function(n,e,t){s({schema:n.schema,rootValue:r,graphiql:!0})(n,e,t)});var o=process.env.PORT||3e3;c.listen(o,function(){return console.log("Started listening at "+o,m)})})},function(n,e){n.exports=require("express")},function(n,e){n.exports=require("express-graphql")},function(n,e){n.exports=require("graphql")},function(n,e){n.exports=require("request")}]);
//# sourceMappingURL=index.js.map